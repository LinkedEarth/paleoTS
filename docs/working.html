

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Working with PaleoTS: a Tutorial &mdash; paleoTS 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reproducing a scientific workflow with paleoTS" href="workflow.html" />
    <link rel="prev" title="Installing PaleoTS" href="installing.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> paleoTS
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">What is PaleoTS?</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="philosophy.html">The philosophy behind PaleoTS</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently asked questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="account.html">Creating an account</a></li>
<li class="toctree-l1"><a class="reference internal" href="installing.html">Installing PaleoTS</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Working with PaleoTS: a Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#wings-login">WINGS login</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-a-workflow">Running a workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#running-a-workflow-with-multiple-datasets">Running a workflow with multiple datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#specializing-a-workflow">Specializing a workflow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#understanding-data-types">Understanding data types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adding-datatypes">Adding Datatypes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#uploading-new-data">Uploading new data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#registering-data-from-the-output-of-an-existing-workflow">Registering data from the output of an existing workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-new-workflows-with-existing-components">Creating new workflows with existing components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-breakpoint">Creating a breakpoint</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#inspecting-existing-components">Inspecting existing components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#abstract-component">Abstract Component</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#i-o">I/O</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rules">Rules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#documentation">Documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#provenance">Provenance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#executable-component">Executable Component</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#io">IO</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">Documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Rules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#code">Code</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#updating-the-version-of-pyleoclim">Updating the version of Pyleoclim</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updating-existing-components">Updating existing components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#updating-io">Updating IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="#updating-the-code">Updating the code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fixing-to-a-specific-version-of-pyleoclim">Fixing to a specific version of Pyleoclim</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#creating-new-components">Creating new components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-your-own-packages">Using your own packages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#adding-rules">Adding rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#terminology">Terminology</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#abstract-workflow">Abstract workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#executable-workflow">Executable workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#domain">Domain</a></li>
<li class="toctree-l3"><a class="reference internal" href="#computational-workflow">Computational Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#workflow-component">Workflow Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-type">Data Type</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Learn More</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Reproducing a scientific workflow with paleoTS</a></li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Relevant Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="citing.html">Citing paleoTS</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">paleoTS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Working with PaleoTS: a Tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/working.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="working-with-paleots-a-tutorial">
<span id="working"></span><h1>Working with PaleoTS: a Tutorial<a class="headerlink" href="#working-with-paleots-a-tutorial" title="Permalink to this heading">¶</a></h1>
<p>If you haven’t done so already, we recommend you read the <a class="reference internal" href="philosophy.html#philosophy"><span class="std std-ref">The philosophy behind PaleoTS</span></a> first.</p>
<section id="wings-login">
<h2>WINGS login<a class="headerlink" href="#wings-login" title="Permalink to this heading">¶</a></h2>
<p>PaleoTS is a specific application of the <a class="reference external" href="https://knowledgecaptureanddiscovery.github.io/autoTS/">autoTS ecosystem</a>. You can either <a class="reference internal" href="account.html#create-account"><span class="std std-ref">create an account</span></a> on our server or <a class="reference internal" href="installing.html#installing"><span class="std std-ref">install WINGS and the PaleoTS domain</span></a> on your own system. If using our server, go to <a class="reference external" href="https://datascience4all.org/wings-portal-new/">the WINGS portal</a>. You will be presented with this login screen:</p>
<img alt="_images/WINGSPage.png" src="_images/WINGSPage.png" />
<p>Click on <em>login</em> in the top right corner and enter you credentials on the next page. Once you are logged in, you should see the following:</p>
<img alt="_images/WINGSDomain.png" src="_images/WINGSDomain.png" />
<p>Make sure that the PaleoTS <a class="reference internal" href="#domain"><span class="std std-ref">domain</span></a> is selected (green square on the image above). If not, click on the name of the domain at the top (green square) and select PaleoTS. You can make PaleoTS the default domain by selecting it in the menu (red circle on the figure above) and click on <em>Set Default</em>.</p>
<p>The rest of this tutorial will show you how to use PaleoTS. We advise completing this tutorial in order once as each step builds on understanding from the previous tutorial step. Please refer to the <a class="reference internal" href="#terminology"><span class="std std-ref">Terminology</span></a> section as needed (the relevant terms will be linked in the text for ease of navigation).</p>
</section>
<section id="running-a-workflow">
<h2>Running a workflow<a class="headerlink" href="#running-a-workflow" title="Permalink to this heading">¶</a></h2>
<p>Let’s start with running a simple <a class="reference internal" href="#computational-workflow"><span class="std std-ref">workflow</span></a> with data already uploaded in the system. In the menu bar, click on <em>Analysis</em>, then <em>Run workflow</em>.</p>
<img alt="_images/Run_Run.png" src="_images/Run_Run.png" />
<p>You should land on the following page:</p>
<img alt="_images/Run_ViewScreen.png" src="_images/Run_ViewScreen.png" />
<p>Under the template tabs, you should see a series of workflows, namely (in alphabetical order):</p>
<ul class="simple">
<li><p><strong>DockerPull-Pyleoclim</strong>: This is a special workflow that allows you to get the latest version of the <cite>Pyleoclim package &lt;https://pyleoclim-util.readthedocs.io/en/master/&gt;`_</cite>. We will talk about its use in the section about <a class="reference internal" href="#updating-existing-components"><span class="std std-ref">updating new components</span></a>.</p></li>
<li><p><strong>ExtractTSFromLiPD</strong>: This workflow allows to create a timeseries from an existing dataset stored in the <a class="reference external" href="https://lipd.net">LiPD</a> format.</p></li>
<li><p><strong>Extract_Timeseries</strong>: This is where the PaleoTS magic happens. This particular workflows senses the data (i.e., is the data evenly-spaced, is there a trend) so the framework can decide which methods are valid. This workflow will run automatically when PaleoTS needs to extract information about the data. If you decide to add more rules, you can <a class="reference internal" href="#updating-existing-components"><span class="std std-ref">modify the code</span></a>.</p></li>
<li><p><strong>LiPDDashboard</strong>: This workflows create a <a class="reference external" href="https://pyleoclim-util.readthedocs.io/en/master/core/api.html#pyleoclim.core.lipdseries.LipdSeries.dashboard">dashboard</a> for a specific timeseries stored in a LiPD file.</p></li>
<li><p><strong>Point-to-PointCausality</strong>: This workflows determines <a class="reference external" href="https://pyleoclim-util.readthedocs.io/en/master/core/api.html#pyleoclim.core.series.Series.causality">causality</a> between two time series.</p></li>
<li><p><strong>Point-to-PointCorrelation</strong>: This workflows determines <a class="reference external" href="https://pyleoclim-util.readthedocs.io/en/master/core/api.html#pyleoclim.core.series.Series.correlation">correlation</a> between two time series.</p></li>
<li><p><strong>SpectralAnalysis</strong>: This workflow pre-processes the data and runs <a class="reference external" href="https://pyleoclim-util.readthedocs.io/en/master/core/api.html#pyleoclim.core.series.Series.spectral">spectral analysis</a> on a timeseries.</p></li>
<li><p><strong>WaveletAnalysis</strong>: This workflow pre-processes the data and runs <a class="reference external" href="https://pyleoclim-util.readthedocs.io/en/master/core/api.html#pyleoclim.core.series.Series.wavelet">wavelet analysis</a> on a timeseries.</p></li>
<li><p><strong>XWavelet__Coherence__Analysis</strong>: This workflow pre-processes the data and runs <a class="reference external" href="https://pyleoclim-util.readthedocs.io/en/master/core/api.html#pyleoclim.core.series.Series.wavelet">coherence analysis</a> between two timeseries.</p></li>
</ul>
<p>For this tutorial, let us select the spectral analysis workflow as described in our <a class="reference internal" href="philosophy.html#philosophy"><span class="std std-ref">philosophy</span></a>:</p>
<img alt="_images/Run_SpectralAnalysis.png" src="_images/Run_SpectralAnalysis.png" />
<p>Let’s first have a look at the <a class="reference internal" href="#computational-workflow"><span class="std std-ref">workflow</span></a>:</p>
<img alt="_images/Run_SpectralWorkflow.svg" src="_images/Run_SpectralWorkflow.svg" /><p>It is represented as a graph where the nodes correspond to data/parameters (symbolized by rectangles) and computations (symbolized by parallelograms). The links represent how the data flow from computations to computations. In the first step, we instruct to <em>loadTS</em> (the grey box) by taking an <em>InputTS</em> (the blue box, which represents data) and a parameter called <em>TSID</em> (green box) and outputs <em>OutputTS</em> and a plot, <em>TimeSeriesPlot</em>. This single operation with its inputs/outputs is called a <a class="reference internal" href="#workflow-component"><span class="std std-ref">workflow component</span></a>.</p>
<p>What do the colors represent? Parameters are represented in green. For the most part, data are in deep blue. You may notice that two of the data nodes are red. This represent a breakpoint in the workflow, where we instructed PaleoTS to sense the data using the Extract_Timeseries workflow so it can make a decision on how best to proceed. In this particular example, we have two breakpoints: one set before detrending and one before hypothesizing over missing values. Let’s get back to them once we talk about the last color: grey, which represents abstract steps. Abstract steps are replaced by actual executable computations in the planning stage. In other words, we have several ways of performing an operation and the actual computation will depend on the data.</p>
<p>Let’s go back to our breakpoints and have a look at <em>OutputTS6</em>, which is an input to the detrending computation. Pyleoclim has several <a class="reference external" href="https://pyleoclim-util.readthedocs.io/en/master/core/api.html#pyleoclim.core.series.Series.detrend">detrending options</a>: linear, filtering using the Savitzky-Golay filters and substracting the resulting filtered series from the original, and empirical mode decomposition. Linear detrending is only appropriate if (1) there is a trend in the data, and (2) the trend is linear. If there is no trend in the data, we instruct PaleoTS to skip over this component completely. If the trend is linear, then all methods are appropriate (we also added a no removal functions if no detrending is wished). However, if the trend is not linear, then PaleoTS shouldn’t use an algorithm for linear detrending.</p>
<p>Similarly, if the data in <em>OutputTS8</em> is evenly-spaced in time or the spectral method doesn’t require evenly-spaced datasets, then this step should be skipped altogether.</p>
<p>To do so, components can be annotated with <a class="reference internal" href="#adding-rules"><span class="std std-ref">rules</span></a> that affect the behavior of the workflow. But more on that later. For now, let’s run our first workflow by entering values for our inputs and parameters:</p>
<p>You can do so either by hand (PaleoTS will select datasets appropriate for the <a class="reference internal" href="#understanding-data-types"><span class="std std-ref">type of data</span></a> the program is accepting; in this case data in either JSON or LiPD format)</p>
<img alt="_images/Run_manual.png" src="_images/Run_manual.png" />
<p>or you can let PaleoTS suggest data and parameters by clicking on the two options:</p>
<img alt="_images/Run_suggestparams.png" src="_images/Run_suggestparams.png" />
<p>Let’s run with the following inputs:</p>
<img alt="_images/Run_example.png" src="_images/Run_example.png" />
<p>Here, we selected a perfect sinusoidal signal, with no trend and no missing values. TSID is set to NA (this parameter is only important when using a LiPD file as the input), the method for the <a class="reference external" href="https://pyleoclim-util.readthedocs.io/en/master/core/api.html#pyleoclim.core.series.Series.spectral">frequency vector determination</a> is set to <em>log</em>, the benchmark null hypothesis against a red noise is set to 0.95 (<em>qs</em>), we choose not to remove outliers if any, and we let Pyleoclim decide the best start/end time is interpolation on the time axis is needed by setting to -1 (None in Python).</p>
<p>Now let’s PaleoTS parse all the possible executions by clicking on <em>Plan workflow</em>. You will be presented with the following window:</p>
<img alt="_images/Run_planworkflow.png" src="_images/Run_planworkflow.png" />
<p>Under template, PaleoTS lists all the possible executions based on a draw from each of the methods that can be used to compute a certain step. Let’s have a look at the first one:</p>
<img alt="_images/Run_executableMTM.png" src="_images/Run_executableMTM.png" />
<p>This workflow looks a little bit different than the <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract workflow</span></a> we have been working with. First, you should notice that the grey boxes have been replaced by orange ones. This signals that PaleoTS has planned to use a specific method (for instance, detrending with the Savitzy-Golay method and a multi-taper method for spectral analysis) to run the abstract steps of detrending and spectral analysis. Second, most of the workflow is greyed out. That’s because even though PaleoTS is planning to run these methods, it may not actually do so. Remember that if there is no trend or the data is evenly-spaced, then these components should be skipped in the actual execution. So PaleoTS is just informing you that it can, for sure, run the first two steps before sensing the data and revising its execution plan. Also note that PaleoTS sensed that the data is in JSON format rather than LiPD, and therefore chose the appropriate loading function. Finally, you should have noticed that there are more parameters (green boxes). These correspond to the parameters specific to the method. Their values can be changed by double-clicking on the box.</p>
<p>Let’s <em>Run Selected Workflow</em>:</p>
<img alt="_images/Run_selectworkflow.png" src="_images/Run_selectworkflow.png" />
<p>Click on monitor execution (which can also be accessed from Analysis -&gt; Access Runs):</p>
<img alt="_images/Run_Results.png" src="_images/Run_Results.png" />
<p>The top panel shows you the status of your executions, allows you to delete some executions or reload to monitor progress.</p>
<p>The bottom panel contains four tabs:</p>
<ul class="simple">
<li><p><strong>Data</strong> shows you your input data and set of parameters for this specific run and all intermediate and final outputs (an output is considered final if it’s not reused by another component, so the plots show in the Ouput tab). To save them on your machine, click on the file name. The save icon allows you to save the data into the system for later re-use as input in another workflow.</p></li>
<li><p><strong>Run log</strong>: Describes what happened during the runs. If one of the program returns an error, it will be logged there. Or if a workflow is taking longer than expected, a printout can tell you what PaleoTS is working on (in this case, running spectral analysis on the surrogates AR1). In some instances, the logs will inform you that the data already exist and therefore, the step has been skipped. PaleoTS will therefore only execute standardization once for all the workflows. Furthermore, if the data has already been sensed, then the planning will only consider workflow appropriate for the data if reused in another execution.</p></li>
<li><p><strong>Template</strong>: Shows which <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract workflow</span></a> was used while:</p></li>
<li><p><strong>Executable Workflow</strong> shows you what <a class="reference internal" href="#executable-workflow"><span class="std std-ref">workflow</span></a> has actually been run! Let’s have a look at it in more details:</p></li>
</ul>
<img alt="_images/Run_ExecutableWorkflow.svg" src="_images/Run_ExecutableWorkflow.svg" /><p>The <a class="reference internal" href="#executable-workflow"><span class="std std-ref">executable workflow</span></a> contains all the information about the method applied, the parameter values and the name of the output file for reproducibility. Notice that <em>DetrendSG</em> and <em>gkernel</em> are greyed out. This is because the data has no trend and was evenly-spaced so they were skipped at execution time. Notice that the file name for <em>OutputTS8</em> and <em>OutputTS9</em> are the same, confirming the skip. All names are unique for a given combination of input data, parameters, and programs (including versions of the programs).</p>
<p>Congratulations! You have run your first analysis with PaleoTS. Feel free to go back and select another of the possible executable workflows.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to run all possible <a class="reference internal" href="#executable-workflow"><span class="std std-ref">executable workflows</span></a> for this particular template, select “Plan and Run Workflow”. Note that you will not be able to select specific method parameters in this mode.</p>
</div>
<section id="running-a-workflow-with-multiple-datasets">
<h3>Running a workflow with multiple datasets<a class="headerlink" href="#running-a-workflow-with-multiple-datasets" title="Permalink to this heading">¶</a></h3>
<p>More often that not, we want to run the same workflow on several datasets. In PaleoTS, you can do so by setting the input (<em>InputTS</em>) as a collection. To do so, head to Analysis -&gt; Edit Workflow and select the <em>SpectralAnalysis</em> workflow. Click on <em>InputTS</em> and set “Input should be a collection” to true (red circle).</p>
<img alt="_images/Run_MultipleDatasets.png" src="_images/Run_MultipleDatasets.png" />
<p>Once you have done so, you should notice that all the boxes are doubled. It indicates that PaleoTS will run each component for each file in the collection.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Don’t forget to save the workflow (green box)!!</p>
</div>
<p>In some instances, you may also want to run the workflow over a collection of parameters. This can be done in two ways: 1. dot product (nwise) or 2. cross-product. In a dot product, each value of the parameter corresponds to specific dataset. This is useful, for instance, for our <em>TSID</em> parameter, whose value will be unique for specific variable in each LiPD file in the collection. Cross-products are useful to test a set of parameters, for instance, estimating the significance of the spectral peaks at the 90% and 95% confidence level for each of the dataset in the collection.</p>
<p>To set the parameter as a collection, click on it and check <em>Input should be a Collection</em> as <em>true</em>.</p>
<img alt="_images/Run_ParamCollections.png" src="_images/Run_ParamCollections.png" />
<p>To set whether the behavior should be a dot product or a cross-product, first select the component the parameter is an input of. Under the <cite>Input Data Combination</cite> tab (red circle on the picture below), select the default behavior (xproduct) and then click on <cite>Set Op</cite>:</p>
<img alt="_images/Run_nwise.png" src="_images/Run_nwise.png" />
<p>Since we want to do a dot product for the loading component (one <em>TSID</em> per file), select <em>nwise</em>.</p>
<p>Repeat the same procedure for the <em>qs</em> parameter, an input to the significance testing component but select <em>xproduct</em>:</p>
<img alt="_images/Run_xproduct.png" src="_images/Run_xproduct.png" />
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Don’t forget to save the workflow!!</p>
</div>
<p>To run the workflow, go to Analysis -&gt; Run Workflow and PaleoTS will prompt you to select multiple files (use command+click or option+click on your computer on the dropdown menu) and enter the parameter values as comma-separated values.</p>
</section>
<section id="specializing-a-workflow">
<h3>Specializing a workflow<a class="headerlink" href="#specializing-a-workflow" title="Permalink to this heading">¶</a></h3>
<p>In some cases, you may not be interested in running all possible methods corresponding to a specific abstract step. You can either (1) <a class="reference internal" href="#creating-new-workflows-with-existing-components"><span class="std std-ref">create a new workflow</span></a> or (2) specialize the template. Let’s look at the second option.</p>
<p>Select the spectral analysis workflow:</p>
<img alt="_images/Run_SpectralAnalysis.png" src="_images/Run_SpectralAnalysis.png" />
<p>And click on the component you wish to select a particular method for. Here, let’s take the Spectral Analysis component. Click on the component and toggle the menu to the desired method.</p>
<img alt="_images/Run_specialize.png" src="_images/Run_specialize.png" />
</section>
</section>
<section id="understanding-data-types">
<h2>Understanding data types<a class="headerlink" href="#understanding-data-types" title="Permalink to this heading">¶</a></h2>
<p>To construct appropriate workflows, PaleoTS reasons over the type of data that can be added to the system. Each program specifies which type(s) of data is acceptable as input and which type(s) will be returned as outputs.</p>
<p>Let’s have a look at the different types of data PaleoTS is currently working with. Click on Advanced -&gt; Manage Data:</p>
<img alt="_images/Data_DataTypes.png" src="_images/Data_DataTypes.png" />
<p>Each folder in the tree represents a type of data (<a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a>). Each subfolder means that a particular data type is a child of the parent folder. In short, they share common characteristics but also differences. The choice of data types is dictated by needs and ease of navigation. So far, all of the inputs/outputs in our workflows are either image files (plots) or JSON files (which contains all our data). Hence, it made sense to create types that correspond to these two file formats.</p>
<p>We also have a special category of “InputData” which can either be a time series stored in JSON format or in LiPD format. Why couldn’t we put time series under JSONFile? We could have. However, separate workflows for each type of files would have been needed since PaleoTS can only reason on ‘loadTS’ if the inputs are of the same type (in this case <em>InputData</em>). So <em>InputData</em> was created for convenience.</p>
<p>Select the folder <em>TimeSeries</em> and have a look at the different tabs:</p>
<img alt="_images/Data_TimeSeries.png" src="_images/Data_TimeSeries.png" />
<p>Under <em>Metadata Properties</em>, three properties are considered: <em>isEvenlySpaced</em>, <em>needsEvenlySpaced</em>, and <em>hasTrend</em>, which are needed to reason over the steps in the workflow. If you click on the <em>Metadata Extractor</em> tab, you should see the following:</p>
<img alt="_images/Data_extractor.png" src="_images/Data_extractor.png" />
<p>Notice that <em>TSMetadataExtraction</em> is selected, which is the component making up the entire <em>Extract_Timeseries</em> workflow that we introduced in the <a class="reference internal" href="#running-a-workflow"><span class="std std-ref">introduction</span></a>.</p>
<p>Click on <em>test_perfect_signal.json</em>, which is the input we used in our example workflow:</p>
<img alt="_images/Data_example.png" src="_images/Data_example.png" />
<p>In this case, the metadata has been filled, informing us that the series has no trend and is evenly-spaced.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even though the input data has no trend and is evenly-spaced, PaleoTS cannot make a decision about which steps to run from this information alone. Remember that the input data to the detrending function is actually the output of the standardization step. Similarly, the input to the interpolation step is the output of outliers removal. The outlier removal step could cause the output to be unevenly-spaced. As a consequence, PaleoTS would run the imputation step.</p>
</div>
<p>Next let’s have a look at the different subtypes of JSONFile. We needed to create them because the computations would be different for different <a class="reference internal" href="#data-type"><span class="std std-ref">data types</span></a>. Let’s take our spectral workflow as an example. The first step is to standardize the time series data. This operation implies that a time series is given as an input to the program and a time series is returned at the end. Let’s skip forward to the spectral analysis step. In this case, a time series is given as input but a power spectral density (PSD) is computed and returned as the output. Would you expect to be able to perform the same operation on a PSD than a time series? Not necessarily. As we see in the next workflow step, we perform significance testing on the PSD, which makes no sense for a time series. Similarly, a scalogram plot would look very different from a PSD plot. Hence the same action (e.g., plot) results in different outcomes appropriate for the <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a>.</p>
<p>If you are familiar with object-oriented programing, you can think of the <a class="reference internal" href="#data-type"><span class="std std-ref">data types</span></a> as object on which methods (programs in PaleoTS) are applied. In fact, the <a class="reference internal" href="#data-type"><span class="std std-ref">data types</span></a> in PaleoTS are related to the objects in Pyleoclim.</p>
<p><a class="reference internal" href="#data-type"><span class="std std-ref">Data types</span></a> allow PaleoTS to validate a workflow. If you try to chain two methods, then the output of method 1 should be of the same <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a> as the input of method 2. Otherwise, PaleoTS will inform you that your workflow is invalid.</p>
<p>Do you have to worry about <a class="reference internal" href="#data-type"><span class="std std-ref">data types</span></a>? They will come into play in the following context:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#uploading-new-data"><span class="std std-ref">Uploading new data to PaleoTS</span></a></p></li>
<li><p><a class="reference internal" href="#registering-data-from-the-output-of-an-existing-workflow"><span class="std std-ref">Saving the results of a workflow</span></a></p></li>
<li><p>Creating <a class="reference internal" href="#creating-new-workflows-with-existing-components"><span class="std std-ref">a new workflow from existing components</span></a></p></li>
<li><p>Creating <a class="reference internal" href="#creating-new-components"><span class="std std-ref">new components</span></a></p></li>
</ol>
<section id="adding-datatypes">
<h3>Adding Datatypes<a class="headerlink" href="#adding-datatypes" title="Permalink to this heading">¶</a></h3>
<p>As you become more familiar with paleoTS, you may find that you want to <a class="reference internal" href="#creating-new-components"><span class="std std-ref">create your own components and programs for your research needs</span></a>. In this case, you will need to create new <a class="reference internal" href="#data-type"><span class="std std-ref">data types</span></a>. The mechanics of doing so is easy (first click on the top folder you want to create a <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a> for then click on the <em>Add</em> button above the folders). However, you need to decide whether to create a brand new <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a> (a subfolder of <em>DataObject</em>; by default everything is a subtype of this category) or whether it should be a subtype of an existing <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a>.</p>
<p>We have already seen a practical example of using <em>InputData</em> as its own <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a> so the system could load either a LiPD file or a JSON-serialized Series for the same workflow. The code involved is format-dependent but both return a TimeSeries. We could also decide to load such a Series from a netcdf file (model output). In this case, we would need a new subtype of <em>InputData</em> called <em>netcdf</em>. We will see other examples when a new <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a> may be needed throughout the tutorial.</p>
</section>
</section>
<section id="uploading-new-data">
<h2>Uploading new data<a class="headerlink" href="#uploading-new-data" title="Permalink to this heading">¶</a></h2>
<p>All the workflows included with PaleoTS will require one or two (for correlation and causality) time series of <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a> <em>InputData</em>, either in LiPD format or a JSON-serialized <a class="reference external" href="https://pyleoclim-util.readthedocs.io/en/master/core/api.html#series-pyleoclim-series">Pyleoclim Series object</a>, which is labeled as <em>TimeSeries</em>.</p>
<p>To create a <em>TimeSeries</em> <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a>, you can use Pyleoclim directly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/master/example_data/oni.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dec year&#39;</span><span class="p">],</span><span class="n">value</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;NINO34_ANOM&#39;</span><span class="p">],</span><span class="n">time_name</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;SST anomaly&#39;</span><span class="p">,</span><span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;CE&#39;</span><span class="p">,</span> <span class="n">value_unit</span><span class="o">=</span><span class="s1">&#39;$^\circ$C&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Niño 3.4&#39;</span><span class="p">,</span> <span class="n">clean_ts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pyleo</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">jsonutils</span><span class="o">.</span><span class="n">PyleoObj_to_json</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="s1">&#39;ONI_TS.json&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Once the JSON file is saved on your system, select the <em>TimeSeries</em> folder since we are adding data of this <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a> and click on <em>Upload Files</em>, then <em>Add file</em> in the dialog window:</p>
<img alt="_images/Data_UploadDialog.png" src="_images/Data_UploadDialog.png" />
<p>Navigate to the folder where you saved your JSON-serialized Series and click upload in the navigation bar. Your file is queued for upload. To upload it onto the system, click <em>upload</em> (red circle):</p>
<img alt="_images/Data_UploadAction.png" src="_images/Data_UploadAction.png" />
<p>Select your dataset:</p>
<img alt="_images/Data_SenseMetadata.png" src="_images/Data_SenseMetadata.png" />
<p>Notice that the metadata is empty. You can either fill it by hand if you know the information or click on <em>Sense Metadata</em> for PaleoTS to run the <em>Extract_Timeseries</em> workflow. I chose the second option and here are the results:</p>
<img alt="_images/Data_SensedMetadata.png" src="_images/Data_SensedMetadata.png" />
</section>
<section id="registering-data-from-the-output-of-an-existing-workflow">
<h2>Registering data from the output of an existing workflow<a class="headerlink" href="#registering-data-from-the-output-of-an-existing-workflow" title="Permalink to this heading">¶</a></h2>
<p>In some cases, you may be interested to run a workflow and use the output(s) in another workflow. In this case, you will need to register the results of the first workflow into the PaleoTS database.</p>
<p>To do so, go to Analysis -&gt; Access Runs and select the spectral analysis workflow we have run previously. Let’s register the power spectral density (PSD) with its significance level. To do so, click on the <em>Save</em> icon:</p>
<img alt="_images/Data_Save.png" src="_images/Data_Save.png" />
<p>You can either keep the name (which includes a unique identifier encoding provenance information) or give it a human-readable one (in this case, I chose ‘OutputPSDSig-perfectsignal-mtm’)</p>
<p>Navigate back to your data (Advanced -&gt; ManageData) and you should notice that PaleoTS placed the output in the corresponding folder for the <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a> (in this case, PSDsignificance):</p>
<img alt="_images/Data_PSDSig.png" src="_images/Data_PSDSig.png" />
<p>What is the difference between the <em>PowerSpectralDensity</em> <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a> and the <em>PSDSignificance</em> <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a>? Well, one contains information about the significance, which could matter for future workflows. Let’s say I want to assess the periodicity associated with the peaks in the PSD. I could write a function to detect the peaks in the original spectral density results. However, if I want my program to also tell me if these peaks are significant, then I need the significance information. In other words, the first program could be run on either <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a>. The other would require the <em>PSDSignificance</em> <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a>.</p>
<p>If I were to create such a program (detect the periodicities corresponding to significant peaks), I could probably save the outputs in a TextFile or a JSONFile. If all is needed is store the information, I can use the existing datatypes <em>TextFile</em> and <em>JSONFile</em> respectively. However, if I expect to reuse these outputs in another workflow (e.g., create a function that take a collection of these files and calculate in how many records a specific periodicity is found), then the outputs would need their own <a class="reference internal" href="#data-type"><span class="std std-ref">data subtypes</span></a>.</p>
<p>Does this mean that I have to know in advance all the functions I will ever create? No. You can always create new <a class="reference internal" href="#data-type"><span class="std std-ref">data types</span></a> as needed and drag and drop files/adjust the <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a> corresponding to your components. We will talk about the last one in more details <a class="reference internal" href="#creating-new-components"><span class="std std-ref">later in this tutorial</span></a>.</p>
</section>
<section id="creating-new-workflows-with-existing-components">
<h2>Creating new workflows with existing components<a class="headerlink" href="#creating-new-workflows-with-existing-components" title="Permalink to this heading">¶</a></h2>
<p>This section will go over creating new workflows once the components are in the system. We will cover <a class="reference internal" href="#creating-new-components"><span class="std std-ref">how to create new components</span></a> in the following section.</p>
<p>As an example, I want to create a spectral analysis workflow which doesn’t involve much pre-processing. Standardization is always a good idea but detrending and removal of outliers seem like too much pre-processing on the data. So I want to create a simple workflow that takes a time series, interpolates if needed, standardizes it, run spectral analysis and assess significance level.</p>
<p>Go to Analysis -&gt; Edit Workflow, click on <em>New</em>, and name the workflow <em>SpectralAnalysis-MinimumPreprocessing</em>:</p>
<img alt="_images/NewWorkflow_Name.png" src="_images/NewWorkflow_Name.png" />
<p>Click on the <em>Components</em> tab:</p>
<img alt="_images/NewWorkflow_Components.png" src="_images/NewWorkflow_Components.png" />
<p>You will get a list of all the <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract components</span></a> and <a class="reference internal" href="#executable-workflow"><span class="std std-ref">executable components</span></a> available to you. Let’s go quickly over this tab. The folders are purely organizational and group the components according to broad functionalities (e.g., pre-processing, analysis, data loading). The names associated with grey puzzle pieces correspond to <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract components</span></a> under which the <a class="reference internal" href="#executable-workflow"><span class="std std-ref">executable components</span></a> corresponding to the abstract step are listed with orange puzzle pieces.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can create workflows with <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract components</span></a> and /or <a class="reference internal" href="#executable-workflow"><span class="std std-ref">executable components</span></a>. The choice depends on what you are trying to accomplish. If you know that you will be executing only one methods, then using the <cite>executable component &lt;Executable workflow&gt;</cite> directly is fine. However, if you want to use the reasoning capabilities of PaleoTS on the <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a> or explore the choice of methods on the results, then working with <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract components</span></a> is preferable.</p>
</div>
<p>The first step in our workflow is to load the data. The <em>loadTS</em> <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract component</span></a> is available under the <em>LoadData</em> folder.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you know that you will only be using the <em>TimeSeries</em> <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a>, then you may choose the <em>loadJSON</em> component directly.</p>
</div>
<p>Click on <em>loadTS</em> and drag it into the workspace to the right:</p>
<img alt="_images/NewWorkflow_DropFirstComponent.png" src="_images/NewWorkflow_DropFirstComponent.png" />
<p>Notice the two circles at the top of the components and the bottom. They indicate that the components take two inputs (data and/or parameters) and two outputs. If you place your cursor on each circle, PaleoTS will tell you which input/output port they correspond to. Click on each circle and drag and drop the corresponding box in the workspace:</p>
<img alt="_images/NewWorkflow_inputoutput.png" src="_images/NewWorkflow_inputoutput.png" />
<p>The next step is <em>HyposthesizeOverMissingValues</em>. Drag the <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract component</span></a> into the workspace and expand the outputs. The <a class="reference internal" href="#workflow-component"><span class="std std-ref">component</span></a> takes three inputs: a timeseries (in this case the output from <em>loadTS</em> called <em>OututTS</em> and two parameters, <em>start</em> and <em>stop</em>). Drag the parameters to an empty space. Click on the InputTs port and start dragging it. You should notice that the ports compatible with the <a class="reference internal" href="#data-type"><span class="std std-ref">data type</span></a> shows up in red. Go ahead and drop your input port on the circle below <em>OutputTS</em>. Your workflow should now look like:</p>
<img alt="_images/NewWorkflow_SecondComponent.png" src="_images/NewWorkflow_SecondComponent.png" />
<p>Almost halfway there! Things are getting a little bit crowded. Look at the tools in the right corner of the canvas (red circle in the figure above):</p>
<ul class="simple">
<li><p>Layout: Allows you to align the nodes/straighten the links of the workflow graph, giving it a more tidy appearance.</p></li>
<li><p>The magnifying glasses allow you to Zoom in/zoom out of the canvas</p></li>
<li><p>Grab image allows you to obtain an image-file of your workflow graph that you can share to describe your analysis.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These tools are also accessible from the results page to allow you to share the analysis used to obtain your data and support your conclusions.</p>
</div>
<p>Now let’s add the <em>Standardizations</em>, <em>Spectral</em>, and <em>SpectralSignificanceTesting</em> <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract components</span></a> (the last two are located under the <em>Analysis</em> folder). You should obtain the following workflow (Image courtesy of the grab image functionality):</p>
<img alt="_images/NewWorkflow_Final.svg" src="_images/NewWorkflow_Final.svg" /><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Don’t forget to save your workflow!</p>
</div>
<p>Go to Analysis -&gt; Run workflow and try it out!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The spectral workflow included in PaleoTS already covers limited processing cases. Notice that the <em>Detrend</em> <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract component</span></a> contains a NoDetrending method that can selected at planning. <em>RemoveOutliers</em> can be set to <em>false</em> (default). In this case, the program will return which outliers have been detected but keep them in the series. Finally, all spectral methods perform standardization within the <em>Spectral</em> component.</p>
</div>
<section id="creating-a-breakpoint">
<h3>Creating a breakpoint<a class="headerlink" href="#creating-a-breakpoint" title="Permalink to this heading">¶</a></h3>
<p>Breakpoints are used by PaleoTS to signal when metadata should be sensed in order to plan the next execution. Acting on the metadata is set through rules on the components, which we will cover <a class="reference internal" href="#adding-rules"><span class="std std-ref">at the end of the tutorial</span></a>. However, rules are already set for the hypothesizing over missing values and spectral analysis. We just need to signal a breakpoint in our <em>SpectralAnalysis-MinimumPreprocessing</em>.</p>
<p>Go to Analysis -&gt; Edit Workflows and select the <em>SpectralAnalysis-MinimumPreprocessing</em> workflow. In this case, we want to sense metadata before the hypothesizing over missing value step, on the output called <em>OutputTS</em>. Click on the node:</p>
<img alt="_images/BreakPoint_Setting.png" src="_images/BreakPoint_Setting.png" />
<p>And toggle <em>Set Breakpoint for fetching metadata</em> to <em>true</em>. The node should now appear in red:</p>
<img alt="_images/BreakPoint_SetBreakpoint.svg" src="_images/BreakPoint_SetBreakpoint.svg" /><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Don’t forget to save your workflow!</p>
</div>
<p>And experiment with your new workflow in Analysis -&gt; Run Workflow</p>
</section>
</section>
<section id="inspecting-existing-components">
<h2>Inspecting existing components<a class="headerlink" href="#inspecting-existing-components" title="Permalink to this heading">¶</a></h2>
<p>Notice that so far we haven’t seen a line of code. This is what PaleoTS (and WINGS before it) was designed to do: compose workflows for a science application without worrying about coding. However, you may be interested in <a class="reference internal" href="#updating-existing-components"><span class="std std-ref">updating the code</span></a> or even <a class="reference internal" href="#creating-new-components"><span class="std std-ref">create your own</span></a>. So let’s have a look at the interface in PaleoTS that allows you to enter your own code!</p>
<p>Go to Advanced -&gt; Manage Components:</p>
<img alt="_images/Component_getto.png" src="_images/Component_getto.png" />
<p>You should see the following list of components:</p>
<img alt="_images/Component_list.png" src="_images/Component_list.png" />
<p>The folders help us organize the abstract component according to their category (e.g., analysis, pre-processing). They don’t have a particular meaning beyond organization and you can choose to re-organize the components as you wish.</p>
<section id="abstract-component">
<h3>Abstract Component<a class="headerlink" href="#abstract-component" title="Permalink to this heading">¶</a></h3>
<p>Let’s have a closer look at the components in <em>Analysis</em> folder: they are organized according to abstract component step as indicated by the grey puzzle piece. Let’s select the <em>Spectral Analysis</em> piece and have a closer look:</p>
<img alt="_images/Component_AbstractIO.png" src="_images/Component_AbstractIO.png" />
<section id="i-o">
<h4>I/O<a class="headerlink" href="#i-o" title="Permalink to this heading">¶</a></h4>
<p>The first tab (<em>I/O</em>) described the inputs, input parameters and output of the component. Let’s take a look at then one by one. The input here has the name <em>InputTS</em>. As the name (and logic) indicates, to run spectral analysis you need timeseries data. The name itself doesn’t matter (I could have called the input, <em>timeseries</em> or any other names of my choosing); however, I was asked to specify a type. This is where the concept of <a class="reference internal" href="#data-type"><span class="std std-ref">data types</span></a> is important. Here, I’m explicitly telling PaleoTS that the function only makes sense with data of the type <cite>TimeSeries</cite> as it wouldn’t make a lot of sense to run spectral analysis on non-sequenced data.</p>
<p>The second box concerns itself with the parameters that affect the behavior of the functions that would work across all spectral analysis methods. In our case, only the choice of frequency method is applicable across. This parameter will be the one showing up under Analyis-&gt;run/edit workflows when using <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract components</span></a> to create the workflow.  We will talk about setting method-specific parameter in a couple of paragraphs. Again, you can choose any names for the parameter but you need to select its type. In this case, we give it a string following the <a class="reference external" href="https://pyleoclim-util.readthedocs.io/en/master/core/api.html#pyleoclim.core.series.Series.spectral">documentation of the function in Pyleoclim</a>. If you look closely at the Pyleoclim method, it accepts several arguments:</p>
<ul class="simple">
<li><p>method (str), either ‘wwz’, ‘mtm’, ‘lomb_scargle’, ‘welch’, ‘periodogram’, ‘cwt’. We omit this particular parameter since we will explicitly build <a class="reference internal" href="#executable-workflow"><span class="std std-ref">executable components</span></a> that runs these methods.</p></li>
<li><p>freq_method (str), which we used as the only input parameters</p></li>
<li><p>settings (dict), which represents a dictionary of arguments for the specific method. These arguments should be passed to the <a class="reference internal" href="#executable-workflow"><span class="std std-ref">executable components</span></a> corresponding to the various methods directly.</p></li>
<li><p>freq_kwargs (str): which modifies the behavior of the <em>freq_method</em>. For PaleoTS, we made the assumption that the default behavior will be appropriate in all cases and we therefore dropped the option to modify how the frequency vector is obtained from the various methods listed in <em>freq_method</em>. If this is deemed important, then <a class="reference internal" href="#executable-workflow"><span class="std std-ref">executable components</span></a> with the various options should be created and the <em>freq_method</em> argument removed from the <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract component</span></a></p></li>
</ul>
<p>In our case, only the <cite>freq_method</cite> argument is applicable across all functionalities and is therefore passed as a parameter. These parameters are shown in the abstract workflow that can be set first when running a workflow.</p>
<p>The output data, appropriately named <em>OutputPSD</em>, is of type <em>PowerSpectralDensity</em>. In short, we have informed PaleoTS that the result of a spectral analysis is a Power Spectral Density. If desired, a plot can be made and saved as an additional output. In this case, we refrain from doing so until the <em>SpectralSignificanceTesting</em> step.</p>
</section>
<section id="rules">
<h4>Rules<a class="headerlink" href="#rules" title="Permalink to this heading">¶</a></h4>
<p>The second tab corresponds to rules that we want PaleoTS to follow according to the data. The spectral component tab doesn’t contain any special rules so let’s head over to <em>Detrend</em> under the PreProcessing folder. Select the <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract component</span></a> and go to the rules tab. You should see the following:</p>
<img alt="_images/Rules_noop.png" src="_images/Rules_noop.png" />
<p>The first line informs us that this is non-operation rule (i.e., under certain conditions, skip the component.) In this particular case, we told PaleoTS to not use a detrending operation if there is no trend sensed in the data. Since this rule is applicable regardless of the detrending method (linear or filtering), it makes sense to have it at the abstract component level.</p>
</section>
<section id="documentation">
<h4>Documentation<a class="headerlink" href="#documentation" title="Permalink to this heading">¶</a></h4>
<p>The next tab allows you to write some documentation for your component. As a general rule we did not write any for the abstract components.</p>
</section>
<section id="provenance">
<h4>Provenance<a class="headerlink" href="#provenance" title="Permalink to this heading">¶</a></h4>
<p>The last tab allows you to keep some information about the provenance of the component.</p>
</section>
</section>
<section id="executable-component">
<h3>Executable Component<a class="headerlink" href="#executable-component" title="Permalink to this heading">¶</a></h3>
<p>Next, let’s have a look at an executable component. Click on the <em>Lomb-Scargle</em> method under <em>Spectral</em>:</p>
<img alt="_images/Component_executableIO.png" src="_images/Component_executableIO.png" />
<p>You should find some familiar tabs (i.e., IO, rules, documentation, and provenance) in addition to two new ones: code (yes, this is where you would enter the code!) and dependencies. Let’s start with the tabs we are familiar with.</p>
<section id="io">
<h4>IO<a class="headerlink" href="#io" title="Permalink to this heading">¶</a></h4>
<p>The interface should look familiar and you should notice that some of the parameters from the abstract components were transferred over. However, there are some additional paramters that are specific to these methods:</p>
<ul class="simple">
<li><p><cite>n50</cite>: The number of 50% overlapping segment,</p></li>
<li><p><cite>window</cite>: the type of window to apply,</p></li>
<li><p><cite>average</cite>: How to take the average (mean or median) across the PSD segments.</p></li>
</ul>
<p>How would you know what these parameters correspond to? Well, this is where the documentation tab is useful.</p>
</section>
<section id="id1">
<h4>Documentation<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h4>
<p>Let’s head over to the documentation tab:</p>
<img alt="_images/Component_documentation.png" src="_images/Component_documentation.png" />
<p>Here, we link to the Pyleoclim documentation. Why? Well, this is to ensure that we can keep it up to date at the source (the container) instead of rewriting it in the tab every time the Pyleoclim version updates.</p>
</section>
<section id="id2">
<h4>Rules<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h4>
<p>Click on the <em>Rules</em> tab.</p>
<img alt="_images/Rules_backward_meta.png" src="_images/Rules_backward_meta.png" />
<p>This is where we inform PaleoTS that the Lomb-Scargle method doesn’t require evenly-spaced data. It works in combination with the rules applied to the <em>HypothesizeOverMissingData</em> component. Click on that particular <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract component</span></a> and look at the rules:</p>
<img alt="_images/Rules_skip.png" src="_images/Rules_skip.png" />
<p>This is where our skip rules are. The first rule is similar to the one we use for detrending: if the input timeseries is already evenly-spaced, then there is no need to run this step. The second rule essentially acts on the output timeseries. If the output doesn’t need to be evenly-spaced, then apply the non-operation rule.</p>
</section>
<section id="dependencies">
<h4>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this heading">¶</a></h4>
<p>This tab allows you to specify dependencies for your code:</p>
<img alt="_images/Component_dependencies.png" src="_images/Component_dependencies.png" />
<p>We do not use this tab in PaleoTS since we are using containers to set version/environment for the code. This is the preferred method.</p>
</section>
<section id="code">
<h4>Code<a class="headerlink" href="#code" title="Permalink to this heading">¶</a></h4>
<p>As the name indicates, this is where the computational action is encoded:</p>
<img alt="_images/Component_Code_io.png" src="_images/Component_Code_io.png" />
<p>You can see that the LombScargle folder (component name) contains three files. Let’s have a look at all of them.</p>
<ul class="simple">
<li><p><em>io.sh</em> contains information about input/output. You will never have to touch this file nor generate it by yourself (we will talk about this in more details when <a class="reference internal" href="#creating-new-components"><span class="std std-ref">learning to create new components</span></a>).</p></li>
<li><p><em>run</em> is essentially the bash script to launch the code. Let’s have a look at it:</p></li>
</ul>
<img alt="_images/Component_Code_run.png" src="_images/Component_Code_run.png" />
<p>Line 11 sets the directory for the code.</p>
<p>Line 13 initiates <em>io.sh</em> by declaring how many inputs (first number), parameters (second number) and output (third number) to expect.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>These numbers need to be consistent with the numbers of inputs, parameters, and outputs that you have on the IO tab.</p>
</div>
<p>Line 16 identifies the <a class="reference external" href="https://www.techtarget.com/searchitoperations/definition/Docker-image">Docker image</a> from which we run our Python code.</p>
<p>Line 17 identifies the data directory. This line needs to be there to inform the system where to get the data from.</p>
<p>Line 18 sets up the docker command to run from the container.</p>
<p>Line 20 invokes the Python code needed and passes the value of the parameters.</p>
<ul class="simple">
<li><p><em>LombScargle.py</em> contains the Python code that executes the Lomb-Scargle algorithm:</p></li>
</ul>
<img alt="_images/Component_Code_python.png" src="_images/Component_Code_python.png" />
<p>Lines 1 and 2 imports the needed packages</p>
<p>Lines 5-15 parses the inputs/parameters/outputs set from the command line in the <em>run</em> file. Here, we use the <a class="reference external" href="https://docs.python.org/3/library/argparse.html">argparse</a> package to do so.</p>
<p>Line 18 prints the arguments on the console so you can check the work under the run log tab in the Runs page.</p>
<p>Line 21 loads the timeseries into a <a class="reference external" href="https://pyleoclim-util.readthedocs.io/en/master/core/api.html#series-pyleoclim-series">Pyleoclim Series object</a>.</p>
<p>Line 23 sets a dictionary with the parameters specific to the Lomb-Scargle method.</p>
<p>Line 25 invokes the &lt;Pyleoclim spectral functionality &lt;<a class="reference external" href="https://pyleoclim-util.readthedocs.io/en/master/core/api.html#pyleoclim.core.series.Series.spectral">https://pyleoclim-util.readthedocs.io/en/master/core/api.html#pyleoclim.core.series.Series.spectral</a>&gt;`_ using the Lomb-Scargle method and with the desired parameter values.</p>
<p>Line 26 exports the <a class="reference external" href="https://pyleoclim-util.readthedocs.io/en/master/core/api.html#psd-pyleoclim-psd">Pyleoclim PSD object</a> into a JSON file for the output.</p>
</section>
</section>
</section>
<section id="updating-the-version-of-pyleoclim">
<h2>Updating the version of Pyleoclim<a class="headerlink" href="#updating-the-version-of-pyleoclim" title="Permalink to this heading">¶</a></h2>
<p>As Pyleoclim continues to evolve, you may want to update your version of the code. We made this simple using a workflow <em>DockerPull-Pyleoclim</em>. Go to Analysis -&gt; Run Workflow and select this particular workflow:</p>
<img alt="_images/Pyleoclim_update.png" src="_images/Pyleoclim_update.png" />
<p>Notice that the component is executable (no <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract workflow</span></a>) and takes a single parameter <em>dummy</em>. As the name indicates, the parameter doesn’t affect the code but it is necessary for PaleoTS to know to run this component (remember that PaleoTS will not run the same component twice if the version hasn’t changed and/or the parameters remain the same.)</p>
<p>Enter a parameter value of your choice and run the workflow. Look at the run log on the Analysis-&gt;Access Runs page:</p>
<p>The run log will print out the version of Pyleoclim you are now using!</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Updating Pyleoclim will give you access to new functionalities, which may require you to <a class="reference internal" href="#creating-new-components"><span class="std std-ref">create new components</span></a> as well as changes in existing APIs, which may require <a class="reference internal" href="#updating-existing-components"><span class="std std-ref">updates to existing components</span></a>. If you are unsure on how to change the code, please <a class="reference external" href="mailto:linkedearth&#37;&#52;&#48;gmail&#46;com">contact us</a>.</p>
</div>
<p>There is one more step, which consists of updating the version of every component so PaleoTS knows to rerun the code even if the inputs haven’t changed. Go to Advanced -&gt; Manage Components and right click on the top <em>Component</em> folder, then select <em>clear cache</em> (red circle):</p>
<img alt="_images/Component_updateall.png" src="_images/Component_updateall.png" />
<p>You can now run or re-run your workflows with the newest version of Pyleoclim.</p>
</section>
<section id="updating-existing-components">
<h2>Updating existing components<a class="headerlink" href="#updating-existing-components" title="Permalink to this heading">¶</a></h2>
<p>You may need to update existing components because (1) you desire more inputs/parameters/outputs, (2) the API to the software you are invoking have changed, (3) you decide to use a similar functionality in a different package. In any case, you may be called to (1) update IO and/or (2) update the code. Let’s have a look on how to do this. Note that the changes made in the screenshots used in this section were not saved to PaleoTS (and are, therefore, not available at login).</p>
<section id="updating-io">
<h3>Updating IO<a class="headerlink" href="#updating-io" title="Permalink to this heading">¶</a></h3>
<p>You may need to update IO either because the APIs have changed or because you would like to add parameters/inputs/outputs. Note that in most cases, these will require changes to the code.</p>
<p>Let’s have a look at the <em>loadLipd</em> <a class="reference internal" href="#executable-workflow"><span class="std std-ref">executable component</span></a>:</p>
<img alt="_images/Modifying_IO.png" src="_images/Modifying_IO.png" />
<p>And let’s assume that I want to add another parameter that searches by variable name instead of TSID. Let’s create a parameter called <em>varName</em> by clicking on the <em>Add</em> button below <em>InputParameters</em>:</p>
<img alt="_images/Modifying_AddParameter.png" src="_images/Modifying_AddParameter.png" />
<p>The type should be <em>string</em> and let’s give it a default value of <em>NA</em> since we want to be able to toggle between <em>TSID</em> and <em>varName</em> in the code. You should obtain this:</p>
<img alt="_images/Modifying_ParameterResult.png" src="_images/Modifying_ParameterResult.png" />
<p>Go ahead and save the IO before heading to the code tab.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can follow the same process to edit an <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract component</span></a>. Be aware that these changes will not be automatically applied to existing <a class="reference internal" href="#executable-workflow"><span class="std std-ref">executable components</span></a> the <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract component</span></a> applies to. Don’t forget to add/remove any inputs/parameters/outputs to these components as well.</p>
</div>
</section>
<section id="updating-the-code">
<h3>Updating the code<a class="headerlink" href="#updating-the-code" title="Permalink to this heading">¶</a></h3>
<p>The original <em>run</em> file shows the following:</p>
<img alt="_images/Modifying_RunOri.png" src="_images/Modifying_RunOri.png" />
<p>We need to modify both line 12 and line 19, which specifies the number and values of the parameters as follow:</p>
<img alt="_images/Modifying_Run.png" src="_images/Modifying_Run.png" />
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Don’t forget to save this file before navigating away from the tab. In this case, we are not interested in keeping the changes, so the file will remain unsaved as indicated by the asterisk near the file name.</p>
</div>
<p>The next step is to change the Python code:</p>
<img alt="_images/Modifying_PythonOri.png" src="_images/Modifying_PythonOri.png" />
<p>The first step will be to add a <em>argparse</em> line that take into account our new parameter before writing a function that would filter by variable name. Don’t forget to put an if statement to decide whether to use the <em>TSID</em> or the <em>varName</em>!</p>
<p>Let’s close the tabs without saving our chasing and head over to the IO tab to remove our parameter. Select the varName parameter box and click <em>Delete</em>, then save:</p>
<img alt="_images/Modifying_Deleting.png" src="_images/Modifying_Deleting.png" />
</section>
<section id="fixing-to-a-specific-version-of-pyleoclim">
<h3>Fixing to a specific version of Pyleoclim<a class="headerlink" href="#fixing-to-a-specific-version-of-pyleoclim" title="Permalink to this heading">¶</a></h3>
<p>In some cases, you may not wish to update Pyleoclim at all, or not update every component with the newest version. We keep all the containers for Pyleoclim dedicated to PaleoTS on <a class="reference external" href="https://quay.io/repository/linkedearth/paleots?tab=tags">quay.io</a>. By default, we use the latest image; however, you may choose to use any images as long as they are stored on the system. To see a list of the Pyleoclim version in each image, visit our <a class="reference external" href="https://github.com/LinkedEarth/paleoTS">GitHub page</a>.</p>
<p>You can do so by using the <em>DockerPull-Pyleoclim</em> workflow and updating the <em>PullPyleoclim</em> <a class="reference internal" href="#executable-workflow"><span class="std std-ref">executable component</span></a> located under the <em>Maintenance</em> folder in <em>Manage Components</em>:</p>
<img alt="_images/Modifying_PullPyleoclim.png" src="_images/Modifying_PullPyleoclim.png" />
<p>On line 16, replace latest by the image tag (e.g., <em>1739e52d17da</em> for v0.9.0 of Pyleoclim). Notice the command on line 17 which instructs the system to pull this particular image. Save the component and run the workflow.</p>
<p>Once this is done, you will also need to change the name of the image for every command you wish this change will apply to. For instance, using the <em>LombScargle</em> component from before:</p>
<img alt="_images/Component_Code_run.png" src="_images/Component_Code_run.png" />
<p>You will need to update line 16 with the image tag you desire (in our example, <em>1739e52d17da</em>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You may need to change the documentation to reflect the version of Pyleoclim you are using for this particular component. The documentation for each version of Pyleoclim is archived. For instance, the documentation for v0.9.0 is available at: <a class="reference external" href="https://pyleoclim-util.readthedocs.io/en/v0.9.0/core/api.html">https://pyleoclim-util.readthedocs.io/en/v0.9.0/core/api.html</a> Note the version number in the URL name. This is all you would have to change in the documentation.</p>
</div>
</section>
</section>
<section id="creating-new-components">
<h2>Creating new components<a class="headerlink" href="#creating-new-components" title="Permalink to this heading">¶</a></h2>
<p>You may also want to create new components. Let’s start by writing a new components with packages available through the Pyleoclim container. You can find a list of these packages <a class="reference external" href="https://github.com/LinkedEarth/paleoTS/blob/main/environment.yml">here</a> for the latest version of the image. Pyleoclim also relies on the packages listed in <a class="reference external" href="https://github.com/LinkedEarth/Pyleoclim_util/blob/master/setup.py">this file</a>, which are also accessible within the container. As you can see, a majority of the packages comprising the scientific Python stack are already available.</p>
<p>Let’s assume that I want to create a workflow that takes a collection of LiPD files and return all the timeseries data into a csv table. Conceptually, the workflow would look like:</p>
<img alt="_images/Workflow_Sketch.png" src="_images/Workflow_Sketch.png" />
<p>Sketching the workflow is often useful to think about the different pieces. The <a class="reference external" href="https://asset.isi.edu">ASSET tool</a> was used here, but a hand drawing/Powerpoint is sufficient in most cases. Let’s first think about the <a class="reference internal" href="#data-type"><span class="std std-ref">data types</span></a> involved in this workflow: LiPD files as inputs and a csv file as an output.</p>
<p>A quick look at the available <a class="reference internal" href="#data-type"><span class="std std-ref">data types</span></a> in  the system tells us that both have already been defined:</p>
<img alt="_images/NewComponent_DataType.png" src="_images/NewComponent_DataType.png" />
<p>However, it makes sense to think about whether the generic csv type is sufficient. If you remember our discussion on <a class="reference internal" href="#data-type"><span class="std std-ref">data types</span></a>, they are more than a simple file format but also define the kind of operations that can be performed on these particular data. Take the example of timeseries: the data is stored in JSON format but the keys in the JSON files are compatible with the <a class="reference external" href="https://pyleoclim-util.readthedocs.io/en/master/core/api.html#series-pyleoclim-series">Pyleoclim Series object</a> on which the computations are performed. Therefore, you could expect different <a class="reference internal" href="#data-type"><span class="std std-ref">data types</span></a> based on what you will need the data for.</p>
<p>Since we are only interested in this small workflow example, let’s use the broad csv category for the output.</p>
<p>The second step is to think about the algorithm: first I will need to open the files, extract the timeseries in each file and store each timeseries as a row in a table with some metadata attached. In short, I want to obtain a table similar to the <a class="reference external" href="https://github.com/LinkedEarth/pyleoDB/blob/main/IPWP_millennial_cycles.ipynb">one displayed in this notebook</a>:</p>
<img alt="_images/NewComponent_Table.png" src="_images/NewComponent_Table.png" />
<p>All of these can be achieved through packages already available through the container: lipd, a package meant to work with paleoclimate data in the LiPD format, pandas to create the table and export it as a csv.</p>
<p>Next, let’s consider which/if folder/<a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract component</span></a> our new code could correspond to. There is a folder named <em>LoadData</em>, which seems like a good place to start. PaleoTS already contains two abstract workflows:</p>
<img alt="_images/NewComponent_LoadData.png" src="_images/NewComponent_LoadData.png" />
<p>Let’s consider whether one of them could work for our purpose. The <em>LipdtoTS</em> component takes data in the LiPD <a class="reference internal" href="#data-type"><span class="std std-ref">data types</span></a>, which is what we want, but returns a TimeSeries <a class="reference internal" href="#data-type"><span class="std std-ref">data types</span></a>:</p>
<img alt="_images/NewComponent_LiPDtoTS.png" src="_images/NewComponent_LiPDtoTS.png" />
<p>But we need a csv <a class="reference internal" href="#data-type"><span class="std std-ref">data types</span></a>. On the other hand, the <em>LoadTS</em> component takes an InputData <a class="reference internal" href="#data-type"><span class="std std-ref">data types</span></a> (remember that InputData is either TimeSeries or LiPD; hence the two <a class="reference internal" href="#executable-workflow"><span class="std std-ref">executable component</span></a> to deal with each type of inputs) and returns a TimeSeries and a plot:</p>
<img alt="_images/NewComponent_loadTS.png" src="_images/NewComponent_loadTS.png" />
<p>This component will not work either for our purpose. So let’s create a new <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract component</span></a>, called LiPDtoTable. To do so, right click on the <em>LoadData</em> folder and select <em>Add Component Type</em>:</p>
<img alt="_images/NewComponent_Create.png" src="_images/NewComponent_Create.png" />
<p>When prompted, enter the name <em>LiPDtoTable</em>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this case, we could have created an <a class="reference internal" href="#executable-workflow"><span class="std std-ref">executable components</span></a> directly.</p>
</div>
<p>With your new <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract component</span></a> selected, enter the appropriate information in the I/O tab: Input should be of type LiPD and the output of type csv. There is not need for parameters for this component.</p>
<img alt="_images/NewComponent_IO.png" src="_images/NewComponent_IO.png" />
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Don’t forget to save!!</p>
</div>
<p>We now need to create the <a class="reference internal" href="#executable-workflow"><span class="std std-ref">executable component</span></a> corresponding to this <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract component</span></a>. Right-click on the <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract component</span></a> and select <em>Add Component</em>:</p>
<img alt="_images/NewComponent_CreateExecutable.png" src="_images/NewComponent_CreateExecutable.png" />
<p>And enter the name <em>LiPD_to_Table</em> when prompted. Notice that the puzzle piece is red instead of orange, signaling that the code is missing from the <a class="reference internal" href="#executable-workflow"><span class="std std-ref">executable component</span></a>.</p>
<p>Select the <em>Lipd_to_Table</em> component. Notice that the I/O is already filled from the information we entered in the <a class="reference internal" href="#abstract-workflow"><span class="std std-ref">abstract component</span></a>. Click on the code tab and select <em>Initialize</em> -&gt; Python:</p>
<img alt="_images/NewComponent_Initialize.png" src="_images/NewComponent_Initialize.png" />
<p>Select yes when prompted to override existing code. PaleoTS created the io.sh, run, and a blank Python script for you to get started. You do not have to touch the io.sh file.</p>
<p>We need to modify the run file to indicate that we want to run from the Pyleoclim container and parse the input/output name:</p>
<img alt="_images/NewComponent_Run.png" src="_images/NewComponent_Run.png" />
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Don’t forget to save!!</p>
</div>
<p>Select the newly created python file and enter your code (you can find a version of this code on our <a class="reference external" href="https://github.com/LinkedEarth/paleoTS">GitHub repo</a>):</p>
<img alt="_images/NewComponent_Python.png" src="_images/NewComponent_Python.png" />
<p>You can now <a class="reference internal" href="#creating-new-workflows-with-existing-components"><span class="std std-ref">create a workflow using this new component</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The component has been deleted after making this tutorial and is not available upon download/login into PaleoTS.</p>
</div>
<section id="using-your-own-packages">
<h3>Using your own packages<a class="headerlink" href="#using-your-own-packages" title="Permalink to this heading">¶</a></h3>
<p>Although the Pyleoclim containers contain many libraries useful for scientific research, you may want to use your own packages. We recommend using Docker containers for execution inside each component. You can find many packages already in containers on registries such as <a class="reference external" href="https://hub.docker.com/search?q=">DockerHub</a> or <a class="reference external" href="https://quay.io/search">quay.io</a>.</p>
<p>If you need to containerize your own packages, we recommend using <a class="reference external" href="https://docs.2i2c.org/en/latest/admin/howto/environment/hub-user-image-template-guide.html">this tutorial</a>.</p>
</section>
</section>
<section id="adding-rules">
<h2>Adding rules<a class="headerlink" href="#adding-rules" title="Permalink to this heading">¶</a></h2>
<p>Under the <em>Rules</em> tab, select <em>Add Rule</em>:</p>
<img alt="_images/Rules_addrules.png" src="_images/Rules_addrules.png" />
<p>You will be presented with the following options:</p>
<ul class="simple">
<li><p><strong>Parameter setting rule</strong>: Creates a rule to set a parameter value based on the metadata of any of the other inputs or outputs.</p></li>
<li><p><strong>Invalidation rule</strong>: Invalidates the component based on all the metadata associated with the inputs (for instance, not applying linear detrending to data with a nonlinear trend). Invalidation rule will stop the workflow (not planning to run this particular combination).</p></li>
<li><p><strong>No-operation Rule</strong>: Skips a specific component based on either the metadata associated with the inputs/outputs (e.g., do not interpolate already evenly-spaced data). Unlike the invalidation rule, this will not completely stop the workflow, just skip this particular component.</p></li>
<li><p><strong>Forward Metadata Propagation Rule</strong>: Propagates the metadata of the inputs down the workflow. In PaleoTS, we use this to propagate the <em>isEvenlySpaced</em> metadata through the pre-processing steps. It would allow to switch the order of operations in the workflow while holding the rule that some spectral methods don’t require evenly-spaced data.</p></li>
<li><p><strong>Backward Metadata Propagation Rule</strong>: Sets the expected input metadata based on the output metadata. Although it is not used directly in PaleoTS, rules could be set for expectation of the output. For instance, the inputs would need to be in specific units given an output specified units. A data transformation could be added to the workflow and toggled on/off depending on units.</p></li>
<li><p><strong>Collection Size Rule</strong>: Gives PaleoTS a hint on how big the output collection is for components (not used currently).</p></li>
</ul>
<p>When you select a category, PaleoTS will create a template based on the current I/O. You need to add the actual rule! The language used is Jena, which can learn more about <a class="reference external" href="https://jena.apache.org/documentation/inference/#RULEbuiltins">here</a>.</p>
</section>
<section id="terminology">
<h2>Terminology<a class="headerlink" href="#terminology" title="Permalink to this heading">¶</a></h2>
<section id="abstract-workflow">
<h3>Abstract workflow<a class="headerlink" href="#abstract-workflow" title="Permalink to this heading">¶</a></h3>
<p>This represent the strategy to follow. For instance, spectral analysis included steps such as detrending. We understand that this means removing a trend from the data. How this trend is removed (i.e., the actual program to be run and the computation to be performed) depends on the data (e.g., is the trend linear? Is there a trend in the data?). Once that determination is made, PaleoTS can then decide with <a class="reference internal" href="#executable-workflow"><span class="std std-ref">Executable workflow</span></a> to run.</p>
</section>
<section id="executable-workflow">
<h3>Executable workflow<a class="headerlink" href="#executable-workflow" title="Permalink to this heading">¶</a></h3>
<p>The workflow that contains <a class="reference internal" href="#workflow-component"><span class="std std-ref">workflow components</span></a> that can be executed through a program. In our detrending example, this would correspond to the code that removes a trend by fitting a line through the data or a savitzy-golay filter.</p>
</section>
<section id="domain">
<h3>Domain<a class="headerlink" href="#domain" title="Permalink to this heading">¶</a></h3>
<p>The name of the space that contains all the workflows, components, and data for a specific application. In this case, you will be using the PaleoTS domain.</p>
</section>
<section id="computational-workflow">
<h3>Computational Workflow<a class="headerlink" href="#computational-workflow" title="Permalink to this heading">¶</a></h3>
<p>Here, we refer to a composition of programs. In the WINGS framework, no user interaction is allowed during the sequential execution. WINGS represent workflows as a graph in which the nodes represent data/parameters and programs and the links represent how the data flow from programs to programs.</p>
</section>
<section id="workflow-component">
<h3>Workflow Component<a class="headerlink" href="#workflow-component" title="Permalink to this heading">¶</a></h3>
<p>A workflow component represents a function (or computation) in the workflow that is implemented as a program with inputs, parameters and outputs.</p>
</section>
<section id="data-type">
<h3>Data Type<a class="headerlink" href="#data-type" title="Permalink to this heading">¶</a></h3>
<p>A data type is defined by the values it can take, the programing language used, or the operations that can be performed on it. As such, it can be more than a file format. For instance, JSON files can only be read through a particular program but they can contain data upon which different operations can be performed: categorical and numerical data can be stored in JSON format, however, taking a mean of the data required for it to be numerical. Categorical data must be transformed into numerical values (for instance assigning a satisfaction score) for the mean to be taken, requiring different operations on the stored data.</p>
</section>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="workflow.html" class="btn btn-neutral float-right" title="Reproducing a scientific workflow with paleoTS" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installing.html" class="btn btn-neutral float-left" title="Installing PaleoTS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, Deborah Khider, Varun Ratnakar, Feng Zhu, Julien Emile-Geay, Yolanda Gil

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>